<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catlytics - Natural Feline Nutrition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* Custom Styles */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FFFDD0; /* Cream */
            color: #2F3E28; /* Dark Olive */
            overflow-x: hidden;
        }
        h1, h2, h3, h4, h5 {
            font-family: 'Merriweather', serif;
        }
        .text-nature-dark { color: #2F3E28; }
        .bg-nature-dark { background-color: #556B2F; }
        .text-accent { color: #E2725B; }
        .bg-accent { background-color: #E2725B; }
        .border-accent { border-color: #E2725B; }
        
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Dekoracje boczne (Koty) - Poprawiona widoczno≈õƒá */
        .cat-deco {
            position: fixed;
            bottom: 0;
            z-index: -1; 
            transition: transform 0.3s ease;
            width: 150px; /* Sta≈Ça szeroko≈õƒá */
        }
        .cat-deco:hover { transform: translateY(-20px) rotate(5deg); }
    </style>
</head>
<body class="antialiased flex flex-col min-h-screen relative">

    <img src="https://cdn-icons-png.flaticon.com/512/1864/1864514.png" 
         class="cat-deco left-[-20px] md:left-0 opacity-20 hidden lg:block" 
         alt="Decor Cat Left">
    
    <img src="https://cdn-icons-png.flaticon.com/512/1864/1864514.png" 
         class="cat-deco right-[-20px] md:right-0 opacity-20 hidden lg:block" 
         style="transform: scaleX(-1);" 
         alt="Decor Cat Right">

    <nav class="bg-[#FFFDD0] sticky top-0 z-50 border-b border-nature-dark/10 backdrop-blur-md bg-opacity-90">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold tracking-tight cursor-pointer" onclick="location.reload()">
                Catlytics<span class="text-accent">.</span>
            </div>
            <div class="hidden md:flex items-center gap-8 font-medium text-sm">
                <span class="text-nature-dark cursor-default px-3 py-1 bg-white rounded-full border border-nature-dark/10 text-xs tracking-widest uppercase font-bold">BETA 2.2</span>
            </div>
        </div>
    </nav>

    <main id="app-content" class="flex-grow container mx-auto px-4 py-8 max-w-4xl relative z-10">
    
        <div class="flex border-b-2 border-nature-dark/10 mb-8 bg-white/50 rounded-t-lg shadow-sm">
            <button onclick="switchTab('calculator')" id="tab-btn-calculator" class="flex-1 py-4 text-center font-bold text-nature-dark border-b-4 border-accent transition-colors hover:bg-white">
                üìä Calculator
            </button>
            <button onclick="switchTab('audit')" id="tab-btn-audit" class="flex-1 py-4 text-center font-medium text-gray-400 hover:text-nature-dark transition-colors hover:bg-white">
                üîç Food Audit
            </button>
            <button onclick="switchTab('education')" id="tab-btn-education" class="flex-1 py-4 text-center font-medium text-gray-400 hover:text-nature-dark transition-colors hover:bg-white">
                üéì Learn
            </button>
        </div>
    
        <div id="tab-content-calculator" class="tab-content fade-in">
            <div class="bg-white p-8 rounded-b-3xl rounded-tr-3xl shadow-lg border border-stone-100">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h2 class="text-3xl font-bold text-nature-dark">Calorie Calculator üß¨</h2>
                        <p class="text-gray-600">Calculate your cat's exact DER (Daily Energy Requirement).</p>
                    </div>
                </div>
                
                <form id="calc-form" onsubmit="event.preventDefault(); calculateDER();" class="space-y-6 text-left">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Current Weight (kg)</label>
                            <input type="number" id="calc-weight" step="0.1" min="0.1" class="w-full px-4 py-3 rounded-xl border border-stone-200 focus:border-accent focus:ring-2 focus:ring-accent/20 outline-none bg-stone-50 transition" placeholder="e.g. 5.2" required>
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Neutered?</label>
                            <select id="calc-neuter" class="w-full px-4 py-3 rounded-xl border border-stone-200 focus:border-accent outline-none bg-stone-50 cursor-pointer">
                                <option value="yes">Yes (Standard)</option>
                                <option value="no">No (Intact)</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Life Stage & Condition</label>
                        <select id="calc-stage" class="w-full px-4 py-3 rounded-xl border border-stone-200 focus:border-accent outline-none bg-stone-50 cursor-pointer">
                            <option value="adult">Adult (Healthy Weight)</option>
                            <option value="overweight">Overweight (Needs Weight Loss) üìâ</option>
                            <option value="kitten">Kitten (<1 year) üöÄ</option>
                            <option value="senior">Senior (7y+) üê¢</option>
                        </select>
                    </div>
                    <button type="submit" class="w-full bg-nature-dark text-white font-bold py-4 rounded-xl shadow-md hover:bg-[#435725] transition transform active:scale-[0.99] text-lg">
                        üßÆ Calculate Result
                    </button>
                </form>
                
                <div id="calc-result" class="hidden mt-8 p-6 bg-[#E8F3E6] rounded-2xl border border-nature-dark/20 text-center animate-pulse">
                    <p class="text-sm text-nature-dark font-bold uppercase tracking-wider mb-2">Daily Calorie Target</p>
                    <div class="text-5xl font-black text-nature-dark mb-2">
                        <span id="result-calories">0</span> <span class="text-2xl font-normal">kcal</span>
                    </div>
                    <p id="result-msg" class="text-sm text-nature-dark/80 font-medium">Based on veterinary RER formula.</p>
                </div>
            </div>
        </div>
    
        <div id="tab-content-audit" class="tab-content hidden">
            <div class="bg-white p-8 rounded-b-3xl rounded-tl-3xl shadow-lg border border-stone-100">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold mb-2 text-nature-dark">Food Audit üîç</h2>
                    <p class="text-gray-600">Enter brand name to check for harmful ingredients.</p>
                </div>
                
                <div class="relative max-w-2xl mx-auto">
                    <input type="text" id="food-search-input" class="w-full pl-14 pr-4 py-4 rounded-full border-2 border-stone-200 focus:border-accent focus:ring-4 focus:ring-accent/10 outline-none bg-stone-50 text-lg shadow-sm" placeholder="e.g. Royal Canin Sterilised">
                    <span class="absolute left-5 top-1/2 -translate-y-1/2 text-2xl">ü•´</span>
                </div>
        
                <div class="max-w-2xl mx-auto mt-4">
                    <button onclick="runAudit()" id="audit-btn" class="w-full bg-nature-dark text-white font-bold py-4 rounded-full shadow-md hover:bg-[#435725] transition transform active:scale-[0.99]">
                        Analyze Label
                    </button>
                </div>
        
                <div id="audit-result" class="hidden mt-10 border-t border-dashed border-gray-200 pt-8">
                    <div class="mb-8">
                        <div class="flex items-center justify-between mb-2">
                            <div>
                                <h3 class="font-bold text-xl text-nature-dark">Quality Score</h3>
                                <p class="text-sm text-gray-500">Species-appropriate check</p>
                            </div>
                            <div id="ai-score" class="text-4xl font-black text-nature-dark">?</div>
                        </div>

                        <div class="relative h-6 w-full rounded-full shadow-inner bg-gray-100 overflow-hidden">
                            <div class="absolute inset-0" style="background: linear-gradient(90deg, #ef4444 0%, #eab308 50%, #22c55e 100%); opacity: 0.8;"></div>
                            <div id="score-indicator" class="absolute top-1/2 -translate-y-1/2 w-8 h-8 bg-white border-4 border-white shadow-lg rounded-full transition-all duration-1000 ease-out" style="left: 0%;"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500 mt-2 font-bold uppercase tracking-wider">
                            <span>Toxic ‚ò†Ô∏è</span>
                            <span>Average ü§∑</span>
                            <span>Excellent üèÜ</span>
                        </div>
                    </div>
        
                    <div class="bg-red-50 p-5 rounded-xl border border-red-100 mb-6 flex gap-4 items-start shadow-sm">
                        <div class="bg-white p-2 rounded-full shadow-sm text-xl">‚ö†Ô∏è</div>
                        <div>
                            <p class="text-sm font-bold text-red-800 uppercase tracking-wide">Primary Concern</p>
                            <p id="ai-redflag" class="text-lg text-red-700 font-medium mt-1">Analyzing...</p>
                        </div>
                    </div>
        
                    <div class="relative overflow-hidden rounded-xl bg-stone-50 p-6 border border-stone-200">
                        <div class="filter blur-[4px] select-none opacity-60">
                            <h4 class="font-bold text-lg mb-2">Detailed Breakdown:</h4>
                            <p class="text-sm mb-2"><strong>Protein Quality:</strong> Analysis of meat sources vs plant proteins...</p>
                            <p class="text-sm mb-2"><strong>Carbohydrate Load:</strong> Estimated dry matter basis...</p>
                        </div>
                        <div class="absolute inset-0 flex flex-col items-center justify-center bg-white/40 backdrop-blur-[1px]">
                            <p class="text-nature-dark font-bold mb-3 text-shadow-sm">Unlock the full truth about this food</p>
                            <button onclick="alert('Premium feature coming in Step 5!')" class="bg-accent text-white font-bold px-8 py-3 rounded-full shadow-xl hover:scale-105 transition flex items-center gap-2">
                                <span>üîì</span> Unlock Full Report ($1.00)
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <div id="tab-content-education" class="tab-content hidden">
    <div class="bg-white p-8 rounded-b-3xl rounded-tl-3xl shadow-lg border border-stone-100">
        <h2 class="text-3xl font-bold mb-6 text-nature-dark">Cat Nutrition 101 üéì</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <div class="bg-stone-50 p-6 rounded-2xl border border-stone-200 hover:border-accent hover:shadow-md transition cursor-pointer group">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform duration-300 origin-left">ü•©</div>
                <h3 class="font-bold text-xl text-nature-dark mb-2">Cats are Carnivores</h3>
                <p class="text-sm text-gray-600 leading-relaxed">Why plant-based protein doesn't work for felines. Understanding obligate carnivores.</p>
            </div>

            <div class="bg-stone-50 p-6 rounded-2xl border border-stone-200 hover:border-accent hover:shadow-md transition cursor-pointer group">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform duration-300 origin-left">üíß</div>
                <h3 class="font-bold text-xl text-nature-dark mb-2">The Thirst Trap</h3>
                <p class="text-sm text-gray-600 leading-relaxed">Cats have a low thirst drive. Learn why wet food is crucial for kidney health.</p>
            </div>

            <div class="bg-stone-50 p-6 rounded-2xl border border-stone-200 hover:border-accent hover:shadow-md transition cursor-pointer group">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform duration-300 origin-left">üè∑Ô∏è</div>
                <h3 class="font-bold text-xl text-nature-dark mb-2">Decoding Labels</h3>
                <p class="text-sm text-gray-600 leading-relaxed">What is "Meat Derivatives"? How to spot hidden sugars in popular brands.</p>
            </div>

            <div class="bg-stone-50 p-6 rounded-2xl border border-stone-200 hover:border-accent hover:shadow-md transition cursor-pointer group">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform duration-300 origin-left">‚öñÔ∏è</div>
                <h3 class="font-bold text-xl text-nature-dark mb-2">Safe Weight Loss</h3>
                <p class="text-sm text-gray-600 leading-relaxed">How to reduce calories without causing hepatic lipidosis.</p>
            </div>

        </div>
    </div>
</div>
    
    </main>

    <footer class="bg-nature-dark text-white py-12 mt-auto relative z-10">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-3 gap-8 text-center md:text-left">
                <div>
                    <div class="text-2xl font-bold mb-4">Catlytics<span class="text-accent">.</span></div>
                    <p class="text-sm opacity-70 leading-relaxed">Medical-grade insights, simplified.</p>
                </div>
                <div>
                    <h4 class="font-bold mb-4 text-[#E8F3E6]">Legal</h4>
                    <ul class="space-y-2 text-sm opacity-80 cursor-pointer">
                        <li><a onclick="openModal('terms')" class="hover:text-accent transition">Terms of Service</a></li>
                        <li><a onclick="openModal('privacy')" class="hover:text-accent transition">Privacy Policy</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4 text-[#E8F3E6]">Feedback</h4>
                    <p class="text-sm opacity-70 mb-4">Love it or hate it?</p>
                    <a href="mailto:catlytics.service@gmail.com?subject=Catlytics%20Feedback" class="inline-block border border-white/30 px-6 py-2 rounded-full hover:bg-white hover:text-nature-dark transition text-sm font-bold">
                        Rate Us / Contact
                    </a>
                </div>
            </div>
            <div class="border-t border-white/10 mt-10 pt-6 text-center text-xs opacity-50">
                &copy; 2025 Catlytics. Not veterinary advice.
            </div>
        </div>
    </footer>

    <div id="legal-modal" class="fixed inset-0 bg-black/50 z-[100] hidden flex items-center justify-center backdrop-blur-sm p-4">
        <div class="bg-white p-8 rounded-2xl max-w-lg w-full max-h-[80vh] overflow-y-auto relative">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-red-500">&times;</button>
            <h2 id="modal-title" class="text-2xl font-bold text-nature-dark mb-4">Legal Info</h2>
            <div id="modal-content" class="text-sm text-gray-600 space-y-4">
                </div>
        </div>
    </div>

    <script>
        // 1. Tab Switching
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-btn-"]').forEach(btn => {
                btn.classList.remove('border-accent', 'text-nature-dark', 'border-b-4', 'font-bold', 'bg-white');
                btn.classList.add('text-gray-400', 'font-medium');
            });
            document.getElementById('tab-content-' + tabId).classList.remove('hidden');
            const activeBtn = document.getElementById('tab-btn-' + tabId);
            activeBtn.classList.remove('text-gray-400', 'font-medium');
            activeBtn.classList.add('border-accent', 'text-nature-dark', 'border-b-4', 'font-bold');
        }

        // 2. Calculator Logic
        function calculateDER() {
            const weight = parseFloat(document.getElementById('calc-weight').value);
            const stage = document.getElementById('calc-stage').value; 
            const neutered = document.getElementById('calc-neuter').value;
    
            if (!weight) return;
    
            const RER = 70 * Math.pow(weight, 0.75);
            let factor = 1.2; 
            let msg = "Standard maintenance.";

            if (stage === 'kitten') { factor = 2.5; msg = "High energy for growth üöÄ"; } 
            else if (stage === 'overweight') { factor = 0.8; msg = "Caloric deficit for weight loss üìâ"; } 
            else if (stage === 'senior') { factor = 1.1; msg = "Senior metabolism üê¢"; } 
            else if (stage === 'adult') { factor = (neutered === 'yes') ? 1.2 : 1.4; msg = (neutered === 'yes') ? "Neutered adult maintenance." : "Active adult maintenance."; }
    
            const DER = Math.round(RER * factor);
            document.getElementById('result-calories').innerText = DER;
            document.getElementById('result-msg').innerText = msg;
            document.getElementById('calc-result').classList.remove('hidden');
        }

        // 3. AI Audit Logic (FIXED)
        async function runAudit() {
            const input = document.getElementById('food-search-input').value;
            const btn = document.getElementById('audit-btn');
            
            if(input.length < 3) return alert("Please enter a brand name.");

            btn.innerText = "Connecting to AI...";
            btn.disabled = true;
            document.getElementById('ai-redflag').innerText = "Scanning ingredients...";

            try {
                // To jest Tw√≥j Webhook. Upewnij siƒô, ≈ºe scenariusz w Make jest w≈ÇƒÖczony (ON)!
                const response = await fetch('https://hook.eu1.make.com/vgzqylk2awqy285v9zut0y2iavlfkpzx', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ query: input })
                });

                if (!response.ok) throw new Error("Server response wasn't OK");

                const data = await response.json();

                // Obs≈Çuga b≈Çƒôdu je≈õli AI zwr√≥ci pustkƒô
                if(!data.score) {
                    throw new Error("Empty response from AI");
                }

                document.getElementById('ai-score').innerText = data.score;
                document.getElementById('ai-redflag').innerText = data.red_flag;

                // Visual Bar Logic
                let scoreNum = parseFloat(data.score.split('/')[0]);
                if (isNaN(scoreNum)) scoreNum = 5;
                let percentage = scoreNum * 10;
                
                const bar = document.getElementById('score-indicator');
                if(bar) {
                    bar.style.left = `calc(${percentage}% - 16px)`; 
                    if(scoreNum < 4) bar.style.borderColor = "#EF4444"; 
                    else if(scoreNum < 7) bar.style.borderColor = "#EAB308"; 
                    else bar.style.borderColor = "#22C55E"; 
                }

                document.getElementById('audit-result').classList.remove('hidden');

            } catch (error) {
                console.error(error);
                alert("B≈ÇƒÖd po≈ÇƒÖczenia z AI. Upewnij siƒô, ≈ºe Make.com jest w≈ÇƒÖczony (ON)!");
            }

            btn.innerText = "Analyze Label";
            btn.disabled = false;
        }

        // 4. Modal Logic
        function openModal(type) {
            const modal = document.getElementById('legal-modal');
            const title = document.getElementById('modal-title');
            const content = document.getElementById('modal-content');
            
            modal.classList.remove('hidden');
            
            if(type === 'terms') {
                title.innerText = "Terms of Service";
                content.innerHTML = "<p>1. By using Catlytics, you agree that this is for informational purposes only.</p><p>2. We are not veterinarians.</p><p>3. AI results may vary.</p>";
            } else if(type === 'privacy') {
                title.innerText = "Privacy Policy";
                content.innerHTML = "<p>1. We do not sell your data.</p><p>2. We use Google Analytics anonymously.</p>";
            }
        }

        function closeModal() {
            document.getElementById('legal-modal').classList.add('hidden');
        }
    </script>
</body>
</html>
